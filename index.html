
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wealth By Brainslap</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Wealth by Brainslap" />
  <link rel="icon" href="favicon.png">
  <meta property="og:title" content="" />
  <meta property="og:description" content="Wealth by Brainslap" />
  <meta property="og:image" content="" />
  <meta name="twitter:card" content="" />
  <meta name="twitter:site" content="" />
  <meta name="twitter:title" content="" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:image" content="" />
  <link rel="manifest" href="manifest.webmanifest">


<link href="https://cdn.jsdelivr.net/gh/tofsjonas/sortable@latest/sortable.min.css" rel="stylesheet" />


</head>

<body>
<h1>Wealth</h1> by Brainslap!
<hr>


<input type="date" id="from_date" name="from_date">
<input type="date" id="to_date" name="to_date">
<br>
<br>
<input type="submit" onclick="all_stocks(stocks);">
<br>
<br>

<!-- <input type="button" text="Sort Table" onclick="table_sort();"> -->


<!-- <div id="result">
</div> -->

<table class='sortable'>
  <thead>
    <tr>
      <th>Stock</th>
      <th>Pattern</th>
      <th>Magnitude</th>
    </tr>
  </thead>
  <tbody id='result'>

  </tbody>
</table>





<script>

var url = "https://query1.finance.yahoo.com/v8/finance/chart/IRCTC.NS?period1=1660726173&period2=1692262173&interval=1wk&events=history&includeAdjustedClose=true";
var add = "https://proxy.cors.sh/";
add = "https://corsproxy.io/?";
var final = add + url;
/* const response = fetch(final); */
/* console.log(response.json); */
async function logMovies(stock) {
  /*  var stock_name = document.getElementById("stock_name").value; */

  var stock_name = stock;

  var from_date = new Date(document.getElementById("from_date").value).getTime() / 1000;
  var to_date = new Date(document.getElementById("to_date").value).getTime() / 1000;
  var cors_proxy = "https://corsproxy.io/?";
  var api_url = "https://query1.finance.yahoo.com/v8/finance/chart/$stock_name$?period1=$from_date$&period2=$to_date$&interval=1wk&events=history&includeAdjustedClose=true";
  api_url = api_url.replace("$stock_name$", stock_name);
  api_url = api_url.replace("$from_date$", from_date);
  api_url = api_url.replace("$to_date$", to_date);
  var final_url = cors_proxy + api_url;
  /*  console.log(final_url); */
  const response = await fetch(final_url);
  const stock_price = await response.json();
  /*  console.log(stock_price); */
  /*   document.getElementById("result").innerText = JSON.stringify(stock_price); */

  var stock_open = stock_price.chart.result[0].indicators.quote[0].open;
  var stock_close = stock_price.chart.result[0].indicators.quote[0].close;
  /*  console.log(stock_open);
   console.log(stock_close);
    */
  var open1 = stock_open[0];
  var close1 = stock_close[stock_close.length - 2];

  var open2 = close1;
  var close2 = stock_close[stock_close.length - 1];

  var magnitude = ((close1 - open1) / open1) * ((close2 - open2) / open2);

  var pattern = 'Other';

  if ((close1 - open1) < 0 && (close2 - open2) > 0) {
    pattern = 'Low then High';
  }

  /* console.log(open1, close1, open2, close2, magnitude); */

  document.getElementById("result").innerHTML += '<tr><td>' + stock_name + '</td><td>' + pattern + '</td><td>' + magnitude + '</td></tr>';

  /*   console.log(from_date);
    console.log(to_date); */
}

function all_stocks(arr) {
  var s = arr;

  for (i = 0; i < s.length; i++) {
    logMovies(s[i]);
  }


}




var stocks = ['IRCTC.NS', 'ASIANPAINT.NS',
  'AXISBANK.NS',
  'BAJAJFINSV.NS',
  'BAJFINANCE.NS',
  'BHARTIARTL.NS',
  'HCLTECH.NS',
  'HDFCBANK.NS',
  'HINDUNILVR.NS',
  'ICICIBANK.NS',
  'INDUSINDBK.NS',
  'INFY.NS',
  'ITC.NS',
  'JSWSTEEL.NS',
  'KOTAKBANK.NS',
  'LT.NS',
  'M&M.NS',
  'MARUTI.NS',
  'NESTLEIND.NS',
  'NTPC.NS',
  'POWERGRID.NS',
  'RELIANCE.NS',
  'SBIN.NS',
  'SUNPHARMA.NS',
  'TATAMOTORS.NS',
  'TATASTEEL.NS',
  'TCS.NS',
  'TECHM.NS',
  'TITAN.NS',
  'ULTRACEMCO.NS',
  'WIPRO.NS'

];



/* logMovies(final); */

</script>

<script src="https://cdn.jsdelivr.net/gh/tofsjonas/sortable@latest/sortable.min.js"></script>

</body>
</html>